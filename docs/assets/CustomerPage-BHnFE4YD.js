import{b as s,j as e}from"./vendor-BOSIRU9y.js";import{P as T,d as w}from"./index-DqQbwsR5.js";import{d as A,f as C,a as j,s as E}from"./vendor_firebase-CiCfdIqM.js";import"./vendor_react-dom-hwKM03QV.js";const i={name:"UFOGER Loyalty Program",description:"Collect punches and earn rewards at our store!"},l=10;function D(){const[u,m]=s.useState("form"),[p,S]=s.useState(""),[c,h]=s.useState(""),[t,f]=s.useState(null),[x,r]=s.useState(!1),[g,a]=s.useState(""),[R,v]=s.useState(""),[N,k]=s.useState(!1);s.useEffect(()=>{t&&t.name&&h(t.name)},[t]);const P=async n=>{n.preventDefault(),a(""),v(""),r(!0);const o=p.trim();if(!o){a("Please enter your phone number."),r(!1);return}const y=A(w,"customers",o);try{const d=await C(y);if(d.exists())f({id:o,...d.data()}),m("info");else{if(!c.trim()){a("Please enter your name."),r(!1);return}const b={id:o,name:c.trim(),punches:0,createdAt:j(),updatedAt:j(),totalRedemptions:0};await E(y,b),f(b),m("info")}}catch{a("Error accessing your record. Please try again.")}r(!1)};return u==="form"?e.jsxs("div",{style:{maxWidth:400,margin:"2rem auto",background:"#fff",borderRadius:12,boxShadow:"0 2px 8px #0001",padding:24},children:[e.jsx("h2",{style:{textAlign:"center"},children:i.name}),e.jsx("p",{style:{textAlign:"center",color:"#555"},children:i.description}),e.jsxs("form",{onSubmit:P,style:{marginTop:24},children:[e.jsxs("label",{children:["Phone Number:",e.jsx("br",{}),e.jsx("input",{type:"tel",value:p,onChange:n=>S(n.target.value),style:{width:"100%",padding:8,marginBottom:12},required:!0})]}),!t&&e.jsxs("label",{children:["Name:",e.jsx("br",{}),e.jsx("input",{type:"text",value:c,onChange:n=>h(n.target.value),style:{width:"100%",padding:8,marginBottom:12}})]}),e.jsx("button",{type:"submit",style:{width:"100%",padding:10,background:"#007bff",color:"#fff",border:"none",borderRadius:6},disabled:x,children:x?"Loading...":"Continue"})]}),g&&e.jsx("div",{style:{color:"red",marginTop:12},children:g})]}):u==="info"&&t?e.jsxs("div",{style:{maxWidth:400,margin:"2rem auto",background:"#fff",borderRadius:12,boxShadow:"0 2px 8px #0001",padding:24},children:[e.jsx("h2",{style:{textAlign:"center"},children:i.name}),e.jsx("p",{style:{textAlign:"center",color:"#555"},children:i.description}),e.jsxs("div",{style:{margin:"1.5rem 0",textAlign:"center"},children:[e.jsx(T,{currentPunches:t.punches||0,totalPunches:l}),e.jsxs("div",{style:{marginTop:8,fontWeight:500},children:[t.punches||0," / ",l," punches"]}),t.punches>=l&&e.jsx("div",{style:{color:"#28a745",marginTop:8},children:"ðŸŽ‰ Reward available! Please redeem in store."})]}),e.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#888",fontSize:13},children:["Your phone: ",t.id]}),e.jsx("div",{style:{marginTop:16,textAlign:"center",color:"#007bff",fontSize:13},children:"To add a punch, please visit UFOGER and ask a staff member."})]}):null}export{D as default};
